@model Web_Calendar.Models.EventModelCollection

@{
    ViewBag.Title = "Admin";
}

@if (ViewBag.Message != null)
{
    <p class="bg-danger">@ViewBag.Message</p>
}

<h2>Admin</h2>

<div class="row">
    <div class="col-lg-12">
        <textarea class="form-control" style="width: 100%; max-width: none; height: 800px" id="results">

</textarea>



        <form id="adminForm" action='/Home/Admin' method='post'>
            <input type="hidden" name="jsonText" id="jsonText" value="test" />
            <input type="submit" id="submitButton" value="Submit" class="btn btn-default" style="margin-top: 10px" />
        </form>
    </div>
</div>

<div class="row">
    <div class="col-lg-12">
        <div class="col-lg-6">
            <table class="table" id="ticketTable">
                <caption>Ticket breakdown</caption>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Tickets</th>
                        <th>Value</th>
                        <th>Paid</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>




<script language="javascript" type="text/javascript">

    function getEvents() {
        $.getJSON('/Home/GetEvents').done(function (data) {

            var jsonPretty = JSON.stringify(data, null, 4);
            $("#results").text(jsonPretty);

        });
    }

    getEvents();

    function getStats() {
        $.getJSON('/Home/GetEventStats').done(function (data) {

            //$('#device').val(navigator.userAgent.toLowerCase());
            //$('#ticketsAvailable').val(data.ticketsOpen);
            //$('#ticketsValue').val(data.ticketOpenValue.toFixed(2));
            //$("#ticketTable tbody tr").remove();
            data.ticketUserList.forEach(function (item) {

                $('#ticketTable').append('<tr><td>' + item.Name + '</td><td>' + item.ticketCount + '</td><td>' + item.ticketValue.toFixed(2) + '</td></tr>');
            });


        });
    }

    getStats();

    $('#adminForm').submit(function () {
        var jsonText = $("#results").val();
        $('#jsonText').val(jsonText);

    });

</script>

